# دليل إضافة ميزة الفلترة المحسنة

## الوصف 
هذا الدليل يشرح كيفية إضافة ميزة البحث المرن للأصناف في نماذج الإذونات، مما يتيح للمستخدمين البحث عن الأصناف حسب:
- كود الصنف
- اسم الصنف
- التصنيف
- وحدة القياس (ميزة جديدة)
- حالة المخزون

## الميزات
- بحث متقدم ومرن عن الأصناف
- فلترة حسب وحدة القياس
- واجهة مستخدم محسنة وسريعة الاستجابة
- خاصية تحميل تلقائي للتصنيفات ووحدات القياس
- عداد لنتائج البحث

## طريقة الإضافة

### الطريقة الموصى بها (بدون تعديل قوالب Django)
لتجنب أي تعارض محتمل مع قوالب Django، نوصي باستخدام هذه الطريقة البسيطة والآمنة:

1. افتح ملف `voucher_form.html` بمحرر نصوص (بدون تعديل قوالب Django)

2. ابحث عن السطر الذي يحتوي على `</body>` (نهاية الصفحة)

3. **قبل** علامة `</body>` مباشرة، أضف السطر التالي:

```html
<script src="/static/inventory/js/direct_filter.js"></script>
```

4. احفظ الملف وقم بتحديث الصفحة

هذه الطريقة لا تتعارض مع قوالب Django ولا تسبب أي خطأ في الصفحة.

### الطريقة اليدوية المباشرة (للمطورين المتقدمين)

إذا كنت ترغب في إضافة السكريبت يدويًا داخل كتلة `{% block extra_js %}`، يمكنك استخدام الأمر التالي في نهاية الكتلة:

```javascript
<script>
document.addEventListener('DOMContentLoaded', function() {
    // إنشاء وإضافة سكريبت الفلترة المحسنة
    const script = document.createElement('script');
    script.src = '/static/inventory/js/direct_filter.js';
    document.body.appendChild(script);
});
</script>
```

ملاحظة: هذه الطريقة أكثر أمانًا من إضافة السكريبت بشكل مباشر داخل قالب Django لأنها تتجنب تعارضات الكتل والأخطاء المحتملة.

## تحري الأخطاء وإصلاحها

إذا واجهت أي مشاكل في تشغيل ميزة الفلترة المحسنة، اتبع الخطوات التالية:

1. افتح وحدة تحكم المتصفح (F12) وتحقق من وجود أي رسائل خطأ
2. تأكد من أن السكريبتات تم تحميلها بنجاح (ستظهر رسائل تأكيد في وحدة التحكم)
3. حاول تحديث الصفحة عدة مرات
4. إذا استمرت المشكلة، قم بمسح ذاكرة التخزين المؤقت للمتصفح

## ملاحظات فنية

- السكريبتات الجديدة توفر دعمًا للفلترة حسب وحدة القياس من خلال إضافة قائمة منسدلة جديدة.
- يتم تحميل التصنيفات ووحدات القياس تلقائيًا عند فتح نافذة البحث.
- تم تحسين استجابة البحث وعرض النتائج.
- تم إضافة عداد للنتائج يعرض عدد الأصناف التي تم العثور عليها.

---

لمزيد من المعلومات، يرجى التواصل مع فريق تطوير البرمجيات.
